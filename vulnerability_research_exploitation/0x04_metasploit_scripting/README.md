# 0. Custom Port Scanner

Create a Metasploit auxiliary module that scans a range of ports on a target system and identifies which ones are open.

- Create a new file in the:
	- `modules/auxiliary/scanner/` named `custom_port_scanner.rb`

- Define the module with the necessary metadata.

- Implement the logic to scan a range of ports and print the open ports.

```
holbertonschool-cyber_security$ msfconsole
msf6 > loadpath /path/to/modules/
Loaded 1 modules:
    1 auxiliary modules
msf6 > use auxiliary/scanner/custom_port_scanner
msf6 auxiliary(scanner/custom_port_scanner) > set RHOST 172.31.128.202
RHOST => 172.31.128.202
msf6 auxiliary(scanner/custom_port_scanner) > set STARTPORT 20
STARTPORT => 20
msf6 auxiliary(scanner/custom_port_scanner) > set ENDPORT 1000
ENDPORT => 1000
msf6 auxiliary(scanner/custom_port_scanner) > run 
[*] Running module against 172.31.128.202

[+] 172.31.128.202:80 - Port 80 is open on 172.31.128.202
[+] 172.31.128.202:80 - Port 111 is open on 172.31.128.202
[+] 172.31.128.202:80 - Port 139 is open on 172.31.128.202
[+] 172.31.128.202:80 - Port 445 is open on 172.31.128.202
[*] 172.31.128.202:80 - Open ports on 172.31.128.202: 80, 111, 139, 445
[*] Auxiliary module execution completed
msf6 auxiliary(scanner/custom_port_scanner) >
```

---

# 1. Vulnerability Checker

Create a module that checks if a target system is vulnerable to the MS17-010 (EternalBlue) vulnerability.

- Choose the MS17-010 vulnerability.
- Write a script to check if the target system is vulnerable to MS17-010.
- Implement the logic to determine if the target is vulnerable.
- Provide meaningful output indicating the presence or absence of the vulnerability.
- Include the target **IP `RHOST`**.

Output

```
holbertonschool-cyber_security$ msfconsole
msf6 > loadpath /path/to/modules/
Loaded 1 modules:
    1 auxiliary modules
msf6 > use auxiliary/scanner/custom_port_scanner
msf6 auxiliary(scanner/custom_port_scanner) > set RHOST 172.31.128.202
RHOST => 172.31.128.202
msf6 auxiliary(scanner/custom_port_scanner) > set STARTPORT 20
STARTPORT => 20
msf6 auxiliary(scanner/custom_port_scanner) > set ENDPORT 1000
ENDPORT => 1000
msf6 auxiliary(scanner/custom_port_scanner) > run 
[*] Running module against 172.31.128.202

[+] 172.31.128.202:80 - Port 80 is open on 172.31.128.202
[+] 172.31.128.202:80 - Port 111 is open on 172.31.128.202
[+] 172.31.128.202:80 - Port 139 is open on 172.31.128.202
[+] 172.31.128.202:80 - Port 445 is open on 172.31.128.202
[*] 172.31.128.202:80 - Open ports on 172.31.128.202: 80, 111, 139, 445
[*] Auxiliary module execution completed
msf6 auxiliary(scanner/custom_port_scanner) >
```
---

# 2. Automated Exploit Launcher

Write a script that automatically launches a chosen exploit against a target system.

- Create a new Metasploit module inside `modules/auxiliary`.
- Accept the target IP, exploit module, and payload as input parameters.
- Configure the module to use the specified exploit and payload, and then execute it.

**Explanation**

- **Initialize the Module**:  
   The `initialize` method sets up the module with the necessary metadata, such as the name, description, author, and license.

- **Register Options**:  
   The `register_options` method defines the input parameters for the module, including:
	- Target IP `RHOST`
	- Exploit module `EXPLOIT`
	- Payload `PAYLOAD`
	- Local IP `LHOST`
	- Local port `LPORT`

- **Run Method**:  
   The `run` method handles the main logic of the module:
	- Retrieves the input parameters and prints the configuration.
	- Creates an instance of the specified exploit module using `framework.exploits.create`.
	- Sets the necessary datastore options for the exploit and payload.
	- Creates an instance of the specified payload module using `framework.payloads.create`.
	- Sets the necessary datastore options for the payload.
	- Launches the exploit using `exploit.exploit_simple`.

This script will automatically configure and launch the specified exploit and payload against the target system.

1. Open `msfconsole`.
2. Load the module using the command:  
   `use auxiliary/automated_exploit_launcher`
3. Set the target IP address:  
   `set RHOST <target-ip>`
4. Set the exploit module:  
   `set EXPLOIT <exploit-module>`
5. Set the payload:  
   `set PAYLOAD <payload>`
6. Set the local IP address:  
   `set LHOST <your-ip>`
7. Set the local port:  
   `set LPORT <your-port>`
8. Run the module:  
   `run`

```bash
msf6 auxiliary(automated_exploit_launcher) > run
[*] Launching exploit <exploit-module> against 172.31.128.202 with payload <payload>
[*] Running exploit...
[*] Sending stage (200262 bytes) to 172.31.128.202
```

---

# 3. Information Gathering Script

Develop a script that gathers various pieces of information from a target system once access is gained.

## Steps

1. Create a Metasploit post-exploitation module:  
   `modules/post/windows/gather`
2. Gather information such as:  
   - OS version  
   - User accounts  
   - Network configuration  
   - Running processes
3. Output the gathered information in a structured format.

## Explanation

1. **Initialize the Module**:  
   The `initialize` method sets up the module with the necessary metadata, such as the name, description, author, and license.

2. **Register Options**:  
   The `register_options` method defines the input parameters for the module, including the session ID (`SESSION`).

3. **Run Method**:  
   The `run` method handles the main logic of the module:  
   - Retrieves the session ID and prints a status message.  
   - Calls various methods to gather information:  
     - **gather_system_info**: Uses the `sysinfo` command to get the operating system and computer name.  
     - **gather_user_info**: Uses the `getuid` command to get user information.  
     - **gather_network_info**: Uses the `session.net.config.interfaces` method to get network interface details, including IP address, netmask, and broadcast address.  
     - **gather_running_processes**: Uses the `ps` command to get a list of running processes, including their PID and name.

## Usage

1. Open `msfconsole`.
2. Use the module:  
   `use post/windows/gather/information_gathering`
3. Set the session ID:  
   `set SESSION <session-id>`
4. Run the module:  
   `run`
```bash
msf6 post(windows/gather/information_gathering) > run
[*] Gathering system information from 172.31.128.202
[*] OS: Windows 10 (Build 14393, 64-bit)
[*] Computer: WIN-ABC1234
[*] User: NT AUTHORITY\SYSTEM
[*] Interface: Ethernet0, IP: 192.168.1.20
[*] Process 1000 - explorer.exe
[*] Process 1050 - cmd.exe
```

---


# 4. Custom Payload Generator

Create a custom payload generator that produces a payload tailored to specific requirements (e.g., a reverse shell with custom encoding).

## Steps

1. Write a Ruby script that generates a custom payload.
2. Ensure the payload is encoded to avoid detection by antivirus software.
3. Test the payload to verify it works as expected.

## Hint

- Check `shikata_ga_nai`.
```bash
msf6 payload(custom_payload_generator) > run
[*] Generating payload with encoding: x86/shikata_ga_nai
[+] Generated encoded payload: \xfc\xe8\x82...
```

